---
export interface Props { selector?: string; title?: string; }
const { selector = "article h2, article h3", title = "Contents" } = Astro.props;
---
<aside id="toc" style="border:1px solid #eee; border-radius:12px; padding:12px; font-size:14px;">
  <div style="font-weight:600; margin-bottom:8px;">{title}</div>
  <nav id="toc-list"></nav>
</aside>

<script>
  const selector = '"article h2, article h3"';
  const nav = document.querySelector('#toc-list');
  const heads = Array.from(document.querySelectorAll(selector));
  if (heads.length && nav) {
    const ul = document.createElement('ul');
    ul.style.listStyle='none'; ul.style.padding='0'; ul.style.margin='0';
    heads.forEach(h => {
      const id = h.id || h.textContent.trim().toLowerCase().replace(/\s+/g,'-').replace(/[^a-z0-9\-]/g,'');
      h.id = id;
      const li = document.createElement('li');
      li.style.margin = '6px 0';
      li.style.paddingLeft = h.tagName === 'H3' ? '12px' : '0';
      const a = document.createElement('a');
      a.href = '#' + id; a.textContent = h.textContent;
      a.style.textDecoration='none'; a.style.color='#111';
      li.appendChild(a); ul.appendChild(li);
    });
    nav.appendChild(ul);
  }
</script>